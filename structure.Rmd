---
title: "Shiny Dashboard Structure"
output:
  html_document:
    highlight: textmate
---

```{r echo = FALSE, message=FALSE}
library(shiny)
library(shinydashboard)
library(webshot)

knitr::opts_chunk$set(collapse = TRUE, comment = "##")

# Print HTML tags as HTML text
knit_print.shiny.tag <- function(x, ...) {
  as.character(x)
}
```

The `dashboardPage()` function expects three components: a header, sidebar, and body:

```{r eval=FALSE}
dashboardPage(
  dashboardHeader(),
  dashboardSidebar(),
  dashboardBody()
)
```

For more complicated apps, splitting app into pieces can make it more readable:

```{r eval=FALSE}
header <- dashboardHeader()

sidebar <- dashboardSidebar()

body <- dashboardBody()

dashboardPage(header, sidebar, body)
```

Now we'll look at each of the three main components of a **shinydashboard**.

### Header

A header can have a title and dropdown menus. Here's an example:

```{r eval=FALSE, echo=FALSE}
appshot('_apps/menus/', 'images/header.png',
  delay=1, vwidth=780, selector="header") %>%
  resize('75%') %>%
  shrink()
```

![Header](images/header.png)

Setting the title is simple; just use the `title` argument:

```{r eval=FALSE}
dashboardHeader(title = "My Dashboard")
```

The dropdown menus are generated by the `dropdownMenu()` function. There are three types of menus, and each one must be populated with a corresponding type of item.

| Type           | Item function        |
|----------------|----------------------|
| `message`      | `messageItem()`      |
| `notification` | `notificationItem()` |
| `task`         | `taskItem()`         |


#### Message menus

A messages menu looks like this:

```{r eval=FALSE, echo=FALSE}
appshot('_apps/menus/', 'images/menu-messages.png',
  delay=0.5, vwidth=780,
  selector = c("header", ".messages-menu .dropdown-menu"),
  eval = "casper.then(function() {
    this.click('.messages-menu a.dropdown-toggle');
    this.wait(500);
  });"
) %>%
  resize('75%') %>%
  shrink()
```

![Messages menu](images/menu-messages.png)


A `messageItem` contained in a message menu needs values for `from` and `message`. You can also control the icon and a notification time string. By default, the icon is a silhouette of a person. ([Read more about icons](icons.html)) The time string can be any text. For example, it could be a relative date/time like `"5 minutes"`, `"today"`, or `"12:30pm yesterday"`, or an absolute time, like `"2014-12-01 13:45"`.

```{r eval=FALSE}
dropdownMenu(type = "messages",
  messageItem(
    from = "Sales Dept",
    message = "Sales are steady this month."
  ),
  messageItem(
    from = "New User",
    message = "How do I register?",
    icon = icon("question"),
    time = "13:45"
  ),
  messageItem(
    from = "Support",
    message = "The new server is ready.",
    icon = icon("life-ring"),
    time = "2014-12-01"
  )
)
```


#### Notification menus

This is what a notification menu looks like:

```{r eval=FALSE, echo=FALSE}
appshot('_apps/menus/', 'images/menu-notifications.png',
  delay=0.5, vwidth=780,
  selector = c("header", ".notifications-menu .dropdown-menu"),
  eval = "casper.then(function() {
    this.click('.notifications-menu a.dropdown-toggle');
    this.wait(500);
  });"
) %>%
  resize('75%') %>%
  shrink()
```

![Notifications menu](images/menu-notifications.png)

A `notificationItem` contained in a notification contains a text notification. You can also control the icon and the status color. The possible statuses are listed in `?validStatuses`.

```{r eval=FALSE}
dropdownMenu(type = "notifications",
  notificationItem(
    text = "5 new users today",
    icon("users")
  ),
  notificationItem(
    text = "12 items delivered",
    icon("truck"),
    status = "success"
  ),
  notificationItem(
    text = "Server load at 86%",
    icon = icon("exclamation-triangle"),
    status = "warning"
  )
)
```


#### Task menus

This is a task menu:

```{r eval=FALSE, echo=FALSE}
appshot('_apps/menus/', 'images/menu-tasks.png',
  delay=0.5, vwidth=780,
  selector = c("header", ".tasks-menu .dropdown-menu"),
  eval = "casper.then(function() {
    this.click('.tasks-menu a.dropdown-toggle');
    this.wait(500);
  });"
) %>%
  resize('75%') %>%
  shrink()
```

![Tasks menu](images/menu-tasks.png)

Task items have a progress bar and a text label. You can also specify the color of the bar. Valid colors are listed in `?validColors`.

```{r eval=FALSE}
dropdownMenu(type = "tasks", badgeStatus = "success",
  taskItem(value = 90, color = "green",
    "Documentation"
  ),
  taskItem(value = 17, color = "aqua",
    "Project X"
  ),
  taskItem(value = 75, color = "yellow",
    "Server deployment"
  ),
  taskItem(value = 80, color = "red",
    "Overall project"
  )
)
```


### Sidebar

A sidebar is typically used for quick navigation. It can contain menu items that behave like tabs in a `tabPanel`, as well as Shiny inputs, like sliders and text inputs.

```{r eval=FALSE, echo=FALSE}
appshot('_apps/sidebar/', 'images/sidebar.png',
  delay=0.5, vwidth=1000,
  selector = c(".header > a.logo", ".sidebar"),
  expand = c(0, 10, 10, 0),
  eval = "casper.then(function() {
    this.click('ul.sidebar-menu > li.treeview > a');
    this.wait(500);
  });"
) %>%
  resize('75%') %>%
  shrink()
```

![Sidebar](images/sidebar.png)


#### Sidebar menu items

Links in the sidebar can be used like `tabPanel`s from Shiny. That is, when you click on a link, it will display different content in the body of the dashboard. Here is an example of a simple tabPanel:

```{r eval=FALSE, echo=FALSE}
appshot('_apps/sidebar-tabs/', 'images/sidebar-tabs.png',
  delay=1, vwidth=1000,
  cliprect = c(0, 0, 800, 300)
) %>%
  resize('75%') %>%
  shrink()
```

![Tabs](images/sidebar-tabs.png)

When the user clicks on one of the menu items, it switches content in the main body:

```{r eval=FALSE, echo=FALSE}
appshot('_apps/sidebar-tabs/', 'images/sidebar-tabs-2.png',
  delay=0.5, vwidth=1000,
  cliprect = c(0, 0, 800, 300),
  eval = "casper.then(function() {
    this.click('ul.sidebar-menu > li > a[href=\"#shiny-tab-widgets\"]');
    this.wait(500);
  });"
) %>%
  resize('75%') %>%
  shrink()
```

![Tabs](images/sidebar-tabs-2.png)


The menu items are put in `sidebarMenu()` as follows. To match up a `menuItem` with a `tabItem`, make sure that they have matching values for `tabName`. 

```{r eval=FALSE}
## ui.R ##
sidebar <- dashboardSidebar(
  sidebarMenu(
    menuItem("Dashboard", tabName = "dashboard", icon = icon("dashboard")),
    menuItem("Widgets", icon = icon("th"), tabName = "widgets",
             badgeLabel = "new", badgeColor = "green")
  )
)

body <- dashboardBody(
  tabItems(
    tabItem(tabName = "dashboard",
      h2("Dashboard tab content")
    ),

    tabItem(tabName = "widgets",
      h2("Widgets tab content")
    )
  )
)

# Put them together into a dashboardPage
dashboardPage(
  dashboardHeader(title = "Simple tabs"),
  sidebar,
  body
)
```

`menuItem`s have an option icon, which is created by the `icon()` function from Shiny. ([More information](icons.html) about using icons.) They also have an optional badge, with `badgeLabel` and `badgeColor`.

A `menuItem` can do other things besides control tabs; it can also contain a link to external content, if you supply a value for `href`. By default, these external links open in a new browser tab or window; this can be controlled with the `newtab` option.

```{r eval=FALSE}
  menuItem("Source code", icon = icon("file-code-o"), 
           href = "https://github.com/rstudio/shinydashboard/")
```


#### Inputs in the sidebar

A sidebar can also contain ordinary inputs, like `sliderInput`s and `textInput`s.

```{r eval=FALSE, echo=FALSE}
appshot('_apps/sidebar-inputs/', 'images/sidebar-inputs.png',
  delay=1, vwidth=1000,
  selector = c(".header > a.logo", ".sidebar"),
  expand = c(0, 10, 10, 0)
) %>%
  resize('75%') %>%
  shrink()
```

![Sidebar inputs](images/sidebar-inputs.png)

**shinydashboard** also includes a special type of input, a `sidebarSearchForm`, which is on top in the screenshot above. This is essentially a specially formatted text input and and actionButton which appears as a magnifying glass icon (the icon can be changed with the `icon` argument).

```{r eval=FALSE}
  sidebarSearchForm(textId = "searchText", buttonId = "searchButton",
                    label = "Search...")
```

For this search form, the corresponding values in the server-side code would be `input$searchText` and `input$searchBotton`.


## Body

The body of a dashboard page can contain any regular Shiny content. However, if you're creating a dashboard you'll likely want to make something that's more structured. The basic building block of most dashboards is a `box`. Boxes in turn can contain any content.

Laying out the boxes requires a little knowledge of the Bootstrap grid layout system. The body can be treated as a region divided in to 12 columns of equal width, and any number of rows, of variable height. When you place a box (or other item) in the grid, you can specify how many of the 12 columns you want it to occupy. In this screenshot, the first row of boxes each are 4 columns wide, and the second column of boxes are each 6 columns wide.

Broadly speaking, there are two ways of laying out boxes: with a row-based layout, or with a column-based layout.

### Row-based layout

In a row-based layout, boxes must go in a row created by `fluidRow()`. Rows have a grid width of 12, so a box with `width=4` takes up one-third of the width, and a box with `width=6` (the default) takes up half of the width.

With a row-based layout, the tops of the boxes in each row will be aligned, but the bottoms may not be -- it depends on the content of each box. A row-based layout might look like this:

```{r eval=FALSE, echo=FALSE}
appshot('_apps/layout-rows/', 'images/layout-rows.png',
  delay=1, vwidth=1000, selector = 'section.content') %>%
  resize("50%") %>%
  shrink()
```

![Row-based layout](images/layout-rows.png)

But it is possible to force the boxes to all be the same height, by setting `height`. In contrast to `width`, which is set using the 12-wide Bootstrap gride, `height` is specified in pixels. (This difference is because HTML/CSS layout handles width and height differently.)

```{r eval=FALSE, echo=FALSE}
appshot('_apps/layout-rows/', 'images/layout-rows-height.png',
  delay=1, vwidth=1000, selector = 'section.content',
  envvars = c(USE_BOX_HEIGHT='TRUE')) %>%
  resize("50%") %>%
  shrink()
```

![Row-based layout with fixed height](images/layout-rows-height.png)

### Column-based layout


### Kinds of boxes

* Standard header
* Solid header
* Solid background

#### valueBox


# Customizing appearance

## CSS file

Title font


## Icons


# Misc
 
